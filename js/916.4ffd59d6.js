"use strict";(self["webpackChunkmall"]=self["webpackChunkmall"]||[]).push([[916],{6041:function(t,c,a){a.d(c,{F:function(){return o}});var e=a(65),s=a(3396);const o=t=>{const c=(0,e.oR)(),a=c.state.cartList;let o=0;const n=(t,a,e,s)=>{c.commit("changeItemToCart",{shopId:t,productId:a,productInfo:e,num:s})},_=(t,a,e,s,n)=>{clearTimeout(o),o=0,o=setInterval((()=>{c.commit("changeItemToCart",{shopId:t,productId:a,productInfo:s,num:n}),c.commit("shopNameToCart",{shopId:t,shopName:e})}),300)},r=(t,a,e,s,n)=>{clearTimeout(o),0!=o&&(c.commit("changeItemToCart",{shopId:t,productId:a,productInfo:s,num:n}),c.commit("shopNameToCart",{shopId:t,shopName:e}))},i=(0,s.Fl)((()=>{const c=a[t]?.productList||{},e={};for(let t in c)c[t].count>0&&(e[t]=c[t]);return e})),l=(0,s.Fl)((()=>{const c=a[t]?.productList;let e=0;if(c)for(let t in c){const a=c[t];a.check&&(e+=a.count*a.price)}return e.toFixed(2)})),d=(0,s.Fl)((()=>a[t]?.shopName||""));return{changeItemToCart:n,changeItemToCart_touch:_,changeItemToCart_handle:r,productList:i,price:l,shopName:d}}},3841:function(t,c,a){a.d(c,{Z:function(){return L}});var e=a(3396),s=a(7139);const o=t=>((0,e.dD)("data-v-54af685d"),t=t(),(0,e.Cn)(),t),n={class:"shop"},_=["src"],r={class:"shop__content__title"},i={class:"shop__content__tags"},l={class:"shop__content__tag"},d={class:"shop__content__tag"},p={class:"shop__content__tag"},u={class:"shop__content__hightlight"},h={key:0,class:"shop__products"},m=["src"],g={class:"shop__product__title"},v={class:"shop__product__price"},C=o((()=>(0,e._)("span",{class:"price__yen"},"¥",-1))),k={class:"price__num"},w={class:"oldPrice__yen"};function I(t,c,a,o,I,f){return(0,e.wg)(),(0,e.iD)("div",n,[(0,e._)("img",{class:"shop__img",src:a.item.imgUrl,alt:""},null,8,_),(0,e._)("div",{class:(0,s.C_)({shop__content:!0,"shop__content--bordered":!a.hideborder})},[(0,e._)("div",r,(0,s.zw)(a.item.name),1),(0,e._)("div",i,[(0,e._)("span",l,"月售"+(0,s.zw)(a.item.sales)+"+",1),(0,e._)("span",d,"起送¥"+(0,s.zw)(a.item.expressLimit),1),(0,e._)("span",p,"基础运费¥"+(0,s.zw)(a.item.expressPrice),1)]),(0,e._)("p",u,(0,s.zw)(a.item.slogan),1),a.item.products?((0,e.wg)(),(0,e.iD)("div",h,[((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(a.item.products,(t=>((0,e.wg)(),(0,e.iD)("div",{class:"shop__product",key:t.name},[(0,e._)("img",{class:"shop__product__img",src:t.imgUrl,alt:""},null,8,m),(0,e._)("p",g,(0,s.zw)(t.name),1),(0,e._)("p",v,[C,(0,e._)("span",k,(0,s.zw)(t.price),1),(0,e._)("span",w,"¥"+(0,s.zw)(t.oldPrice),1)])])))),128))])):(0,e.kq)("",!0)],2)])}var f={name:"shopinfo",props:["item","hideborder"]},T=a(89);const b=(0,T.Z)(f,[["render",I],["__scopeId","data-v-54af685d"]]);var L=b},5916:function(t,c,a){a.r(c),a.d(c,{default:function(){return ut}});var e=a(3396),s=a(9242);const o=t=>((0,e.dD)("data-v-59f30b66"),t=t(),(0,e.Cn)(),t),n={class:"wrapper"},_={class:"search"},r=o((()=>(0,e._)("div",{class:"search__content"},[(0,e._)("span",{class:"search__content__icon iconfont"},""),(0,e._)("input",{class:"search__content__input",placeholder:"请输入商品名称"})],-1)));function i(t,c,a,o,i,l){const d=(0,e.up)("ShopInfo"),p=(0,e.up)("Content"),u=(0,e.up)("Cart");return(0,e.wg)(),(0,e.iD)("div",n,[(0,e._)("div",_,[(0,e._)("div",{class:"search__back iconfont",onClick:c[0]||(c[0]=t=>o.handleBack())},""),r]),(0,e.wy)((0,e.Wm)(d,{item:o.data.item,hideborder:!0,style:{padding:"0 0.18rem"}},null,8,["item"]),[[s.F8,o.data.item.imgUrl]]),(0,e.Wm)(p,{shopName:o.data.item.name},null,8,["shopName"]),(0,e.Wm)(u)])}var l=a(4870),d=a(2483),p=a(212),u=a(3841),h=a(7139);const m=t=>((0,e.dD)("data-v-0b480db7"),t=t(),(0,e.Cn)(),t),g={class:"content"},v={class:"category"},C=["onClick"],k={class:"product"},w=["src"],I={class:"product__item__detail"},f={class:"product__item__title"},T={class:"product__item__sales"},b={class:"product__item__price"},L=m((()=>(0,e._)("span",{class:"product__item__yen"},"¥",-1))),y={class:"product__item__origin"},z={class:"product__num"},D=["onTouchstart","onTouchend"],N={class:"product__num__value"},F=["onTouchstart","onTouchend"];function U(t,c,a,s,o,n){return(0,e.wg)(),(0,e.iD)("div",g,[(0,e._)("div",v,[((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(s.categories,(t=>((0,e.wg)(),(0,e.iD)("div",{class:(0,h.C_)({category__item:!0,"category__item--active":s.currentTab===t.tab}),key:t.name,onClick:()=>s.handleCategories(t.tab)},(0,h.zw)(t.name),11,C)))),128))]),(0,e._)("div",k,[((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(s.contentList,(t=>((0,e.wg)(),(0,e.iD)("div",{class:"product__item",key:t._id},[(0,e._)("img",{class:"product__item__img",src:t.imgUrl,alt:""},null,8,w),(0,e._)("div",I,[(0,e._)("div",f,(0,h.zw)(t.name),1),(0,e._)("p",T,"月售"+(0,h.zw)(t.sales)+"件",1),(0,e._)("p",b,[L,(0,e.Uk)((0,h.zw)(t.price)+" ",1),(0,e._)("span",y,"¥"+(0,h.zw)(t.oldPrice),1)])]),(0,e._)("div",z,[(0,e._)("span",{class:"product__num__minus",onTouchstart:()=>{s.changeItemToCart_touch(s.shopId,t._id,a.shopName,t,-1)},onTouchend:()=>{s.changeItemToCart_handle(s.shopId,t._id,a.shopName,t,-1)}},"-",40,D),(0,e._)("span",N,(0,h.zw)(s.cartList?.[s.shopId]?.productList?.[t._id]?.count||0),1),(0,e._)("span",{class:"product__num__plus",onTouchstart:()=>{s.changeItemToCart_touch(s.shopId,t._id,a.shopName,t,1)},onTouchend:()=>{s.changeItemToCart_handle(s.shopId,t._id,a.shopName,t,1)}},"+",40,F)])])))),128))])])}var H=a(65),P=a(6041),Z={name:"Content",props:["shopName"],setup(){const t=(0,d.yj)(),c=(0,H.oR)(),{cartList:a}=(0,l.BK)(c.state),e=t.params.id,{changeItemToCart_touch:s,changeItemToCart_handle:o}=(0,P.F)(),n=[{name:"全部商品",tab:"all"},{name:"秒杀",tab:"seckill"},{name:"新鲜水果",tab:"fruit"}],_=(0,l.qj)({currentTab:n[0].tab,contentList:[]}),{currentTab:r,contentList:i}=(0,l.BK)(_),u=async t=>{const c=await(0,p.U)(`/api/shop/${e}/products`,{tab:t});0===c?.data?.errno&&(_.contentList=c.data.data)};u("all");const h=t=>{u(t),_.currentTab=t};return{shopId:e,currentTab:r,contentList:i,categories:n,handleCategories:h,cartList:a,changeItemToCart_touch:s,changeItemToCart_handle:o}}},K=a(89);const S=(0,K.Z)(Z,[["render",U],["__scopeId","data-v-0b480db7"]]);var j=S;const q=t=>((0,e.dD)("data-v-fb194a70"),t=t(),(0,e.Cn)(),t),B={class:"cart"},M={key:0,class:"product"},Y={class:"product__header"},x=["innerHTML"],R=q((()=>(0,e._)("div",{class:"product__header__all"},"全选",-1))),W=["innerHTML","onClick"],$=["src"],A={class:"product__item__detail"},E={class:"product__item__title"},G={class:"product__item__price"},J=q((()=>(0,e._)("span",{class:"product__item__yen"},"¥",-1))),O={class:"product__item__origin"},Q={class:"product__num"},V=["onClick"],X={class:"product__num__value"},tt=["onClick"],ct={class:"check"},at={class:"check__icon"},et={class:"check__icon__tag"},st={class:"check__info"},ot={class:"check__info__price"};function nt(t,c,a,s,o,n){return(0,e.wg)(),(0,e.iD)("div",null,[s.showCart&&s.total>0?((0,e.wg)(),(0,e.iD)("div",{key:0,class:"mask",onClick:c[0]||(c[0]=t=>s.handleShowCart())})):(0,e.kq)("",!0),(0,e._)("div",B,[s.showCart&&s.total>0?((0,e.wg)(),(0,e.iD)("div",M,[(0,e._)("div",Y,[(0,e._)("span",{class:"product__header__icon iconfont__check",innerHTML:s.allCheck?"":"",onClick:c[1]||(c[1]=()=>s.allCartCheck(s.shopId))},null,8,x),R,(0,e._)("div",{class:"product__header__clear",onClick:c[2]||(c[2]=t=>s.cleanProduct(s.shopId))}," 清空购物车 ")]),((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(s.productList,(t=>((0,e.wg)(),(0,e.iD)("div",{class:"product__item",key:t._id},[(0,e._)("div",{class:"product__item__checked iconfont__check",innerHTML:t.check?"":"",onClick:()=>s.handleCheck(s.shopId,t._id)},null,8,W),(0,e._)("img",{class:"product__item__img",src:t.imgUrl,alt:""},null,8,$),(0,e._)("div",A,[(0,e._)("div",E,(0,h.zw)(t.name),1),(0,e._)("p",G,[J,(0,e.Uk)((0,h.zw)(t.price)+" ",1),(0,e._)("span",O,"¥"+(0,h.zw)(t.oldPrice),1)])]),(0,e._)("div",Q,[(0,e._)("span",{class:"product__num__minus",onClick:()=>{s.changeItemToCart(s.shopId,t._id,t,-1)}},"-",8,V),(0,e._)("span",X,(0,h.zw)(t.count||0),1),(0,e._)("span",{class:"product__num__plus",onClick:()=>{s.changeItemToCart(s.shopId,t._id,t,1)}},"+",8,tt)])])))),128))])):(0,e.kq)("",!0),(0,e._)("div",ct,[(0,e._)("div",at,[(0,e._)("img",{class:"check__icon__img",src:"http://www.dell-lee.com/imgs/vue3/basket.png",alt:"",onClick:c[3]||(c[3]=t=>s.handleShowCart())}),(0,e._)("div",et,(0,h.zw)(s.total),1)]),(0,e._)("div",st,[(0,e.Uk)(" 总计："),(0,e._)("span",ot,"¥ "+(0,h.zw)(s.price),1)]),(0,e._)("div",{class:"check__btn",onClick:c[4]||(c[4]=t=>s.checkout())},"去结算")])])])}a(7658);var _t=a(1120),rt={name:"Cart",setup(){const t=(0,H.oR)(),c=(0,d.yj)(),a=c.params.id,s=t.state.cartList,o=(0,l.iH)(!1),{changeItemToCart:n,productList:_,price:r}=(0,P.F)(a),i=(0,e.Fl)((()=>{const t=s[a]?.productList;let c=0;if(t){for(let a in t){const e=t[a];c+=e.count}0===c&&(o.value=!1)}return c})),p=(c,a)=>{t.commit("handleCheck",{shopId:c,productId:a})},u=()=>{i.value>0&&(o.value=!o.value)},h=(0,e.Fl)((()=>{const t=s[a]?.productList;let c=!0;if(t)for(let a in t){const e=t[a];e.count>0&&!e.check&&(c=!1)}return c})),m=t=>{o.value=!o.value,s[t]={shopName:"",productList:{}}},g=t=>{const c=s[t]?.productList;if(c)for(let a in c)c[a].check=!0},v=()=>{i.value>0&&_t.Z.push({path:`/orderConfirmation/${a}`})};return{productList:_,shopId:a,cartList:s,total:i,price:r,changeItemToCart:n,handleCheck:p,cleanProduct:m,allCheck:h,allCartCheck:g,showCart:o,handleShowCart:u,checkout:v}}};const it=(0,K.Z)(rt,[["render",nt],["__scopeId","data-v-fb194a70"]]);var lt=it,dt={name:"Shop",components:{ShopInfo:u.Z,Content:j,Cart:lt},setup(){const t=(0,d.tv)(),c=(0,d.yj)(),a=(0,l.qj)({item:{}}),e=async()=>{const t=await(0,p.U)(`/api/shop/${c.params.id}`);200===t.status?a.item=t.data.data:alert("请求失败")};e();const s=()=>{t.back()};return{data:a,handleBack:s}}};const pt=(0,K.Z)(dt,[["render",i],["__scopeId","data-v-59f30b66"]]);var ut=pt}}]);
//# sourceMappingURL=916.4ffd59d6.js.map