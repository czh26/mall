"use strict";(self["webpackChunkmall"]=self["webpackChunkmall"]||[]).push([[916],{6041:function(t,c,a){a.d(c,{F:function(){return s}});var e=a(65),o=a(3396);const s=t=>{const c=(0,e.oR)(),a=c.state.cartList;let s=0;const n=(t,a,e,o)=>{c.commit("changeItemToCart",{shopId:t,productId:a,productInfo:e,num:o})},_=(t,a,e,o,n)=>{clearTimeout(s),s=0,s=setInterval((()=>{c.commit("changeItemToCart",{shopId:t,productId:a,productInfo:o,num:n}),c.commit("shopNameToCart",{shopId:t,shopName:e})}),300)},r=(t,a,e,o,n)=>{clearTimeout(s),0!=s&&(c.commit("changeItemToCart",{shopId:t,productId:a,productInfo:o,num:n}),c.commit("shopNameToCart",{shopId:t,shopName:e}))},i=(0,o.Fl)((()=>{const c=a[t]?.productList||{},e={};for(let t in c)c[t].count>0&&(e[t]=c[t]);return e})),d=(0,o.Fl)((()=>{const c=a[t]?.productList;let e=0;if(c)for(let t in c){const a=c[t];a.check&&(e+=a.count*a.price)}return e.toFixed(2)})),l=(0,o.Fl)((()=>a[t]?.shopName||""));return{changeItemToCart:n,changeItemToCart_touch:_,changeItemToCart_handle:r,productList:i,price:d,shopName:l}}},2381:function(t,c,a){a.d(c,{Z:function(){return v}});var e=a(3396),o=a(7139);const s={class:"shop"},n=["src"],_={class:"shop__content__title"},r={class:"shop__content__tags"},i={class:"shop__content__tag"},d={class:"shop__content__tag"},l={class:"shop__content__tag"},p={class:"shop__content__hightlight"};function u(t,c,a,u,h,m){return(0,e.wg)(),(0,e.iD)("div",s,[(0,e._)("img",{class:"shop__img",src:a.item.imgUrl,alt:""},null,8,n),(0,e._)("div",{class:(0,o.C_)({shop__content:!0,"shop__content--bordered":!a.hideborder})},[(0,e._)("div",_,(0,o.zw)(a.item.name),1),(0,e._)("div",r,[(0,e._)("span",i,"月售"+(0,o.zw)(a.item.sales)+"+",1),(0,e._)("span",d,"起送¥"+(0,o.zw)(a.item.expressLimit),1),(0,e._)("span",l,"基础运费¥"+(0,o.zw)(a.item.expressPrice),1)]),(0,e._)("p",p,(0,o.zw)(a.item.slogan),1)],2)])}var h={name:"shopinfo",props:["item","hideborder"]},m=a(89);const C=(0,m.Z)(h,[["render",u],["__scopeId","data-v-092872e0"]]);var v=C},5916:function(t,c,a){a.r(c),a.d(c,{default:function(){return ut}});var e=a(3396),o=a(9242);const s=t=>((0,e.dD)("data-v-59f30b66"),t=t(),(0,e.Cn)(),t),n={class:"wrapper"},_={class:"search"},r=s((()=>(0,e._)("div",{class:"search__content"},[(0,e._)("span",{class:"search__content__icon iconfont"},""),(0,e._)("input",{class:"search__content__input",placeholder:"请输入商品名称"})],-1)));function i(t,c,a,s,i,d){const l=(0,e.up)("ShopInfo"),p=(0,e.up)("Content"),u=(0,e.up)("Cart");return(0,e.wg)(),(0,e.iD)("div",n,[(0,e._)("div",_,[(0,e._)("div",{class:"search__back iconfont",onClick:c[0]||(c[0]=t=>s.handleBack())},""),r]),(0,e.wy)((0,e.Wm)(l,{item:s.data.item,hideborder:!0,style:{padding:"0 0.18rem"}},null,8,["item"]),[[o.F8,s.data.item.imgUrl]]),(0,e.Wm)(p,{shopName:s.data.item.name},null,8,["shopName"]),(0,e.Wm)(u)])}var d=a(4870),l=a(2483),p=a(212),u=a(2381),h=a(7139);const m=t=>((0,e.dD)("data-v-0b480db7"),t=t(),(0,e.Cn)(),t),C={class:"content"},v={class:"category"},g=["onClick"],k={class:"product"},I=["src"],w={class:"product__item__detail"},f={class:"product__item__title"},T={class:"product__item__sales"},b={class:"product__item__price"},L=m((()=>(0,e._)("span",{class:"product__item__yen"},"¥",-1))),y={class:"product__item__origin"},z={class:"product__num"},D=["onTouchstart","onTouchend"],N={class:"product__num__value"},F=["onTouchstart","onTouchend"];function U(t,c,a,o,s,n){return(0,e.wg)(),(0,e.iD)("div",C,[(0,e._)("div",v,[((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(o.categories,(t=>((0,e.wg)(),(0,e.iD)("div",{class:(0,h.C_)({category__item:!0,"category__item--active":o.currentTab===t.tab}),key:t.name,onClick:()=>o.handleCategories(t.tab)},(0,h.zw)(t.name),11,g)))),128))]),(0,e._)("div",k,[((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(o.contentList,(t=>((0,e.wg)(),(0,e.iD)("div",{class:"product__item",key:t._id},[(0,e._)("img",{class:"product__item__img",src:t.imgUrl,alt:""},null,8,I),(0,e._)("div",w,[(0,e._)("div",f,(0,h.zw)(t.name),1),(0,e._)("p",T,"月售"+(0,h.zw)(t.sales)+"件",1),(0,e._)("p",b,[L,(0,e.Uk)((0,h.zw)(t.price)+" ",1),(0,e._)("span",y,"¥"+(0,h.zw)(t.oldPrice),1)])]),(0,e._)("div",z,[(0,e._)("span",{class:"product__num__minus",onTouchstart:()=>{o.changeItemToCart_touch(o.shopId,t._id,a.shopName,t,-1)},onTouchend:()=>{o.changeItemToCart_handle(o.shopId,t._id,a.shopName,t,-1)}},"-",40,D),(0,e._)("span",N,(0,h.zw)(o.cartList?.[o.shopId]?.productList?.[t._id]?.count||0),1),(0,e._)("span",{class:"product__num__plus",onTouchstart:()=>{o.changeItemToCart_touch(o.shopId,t._id,a.shopName,t,1)},onTouchend:()=>{o.changeItemToCart_handle(o.shopId,t._id,a.shopName,t,1)}},"+",40,F)])])))),128))])])}var H=a(65),Z=a(6041),S={name:"Content",props:["shopName"],setup(){const t=(0,l.yj)(),c=(0,H.oR)(),{cartList:a}=(0,d.BK)(c.state),e=t.params.id,{changeItemToCart_touch:o,changeItemToCart_handle:s}=(0,Z.F)(),n=[{name:"全部商品",tab:"all"},{name:"秒杀",tab:"seckill"},{name:"新鲜水果",tab:"fruit"}],_=(0,d.qj)({currentTab:n[0].tab,contentList:[]}),{currentTab:r,contentList:i}=(0,d.BK)(_),u=async t=>{const c=await(0,p.U)(`/api/shop/${e}/products`,{tab:t});0===c?.data?.errno&&(_.contentList=c.data.data)};u("all");const h=t=>{u(t),_.currentTab=t};return{shopId:e,currentTab:r,contentList:i,categories:n,handleCategories:h,cartList:a,changeItemToCart_touch:o,changeItemToCart_handle:s}}},j=a(89);const K=(0,j.Z)(S,[["render",U],["__scopeId","data-v-0b480db7"]]);var P=K;const q=t=>((0,e.dD)("data-v-fb194a70"),t=t(),(0,e.Cn)(),t),B={class:"cart"},M={key:0,class:"product"},x={class:"product__header"},R=["innerHTML"],W=q((()=>(0,e._)("div",{class:"product__header__all"},"全选",-1))),Y=["innerHTML","onClick"],$=["src"],A={class:"product__item__detail"},E={class:"product__item__title"},G={class:"product__item__price"},J=q((()=>(0,e._)("span",{class:"product__item__yen"},"¥",-1))),O={class:"product__item__origin"},Q={class:"product__num"},V=["onClick"],X={class:"product__num__value"},tt=["onClick"],ct={class:"check"},at={class:"check__icon"},et={class:"check__icon__tag"},ot={class:"check__info"},st={class:"check__info__price"};function nt(t,c,a,o,s,n){return(0,e.wg)(),(0,e.iD)("div",null,[o.showCart&&o.total>0?((0,e.wg)(),(0,e.iD)("div",{key:0,class:"mask",onClick:c[0]||(c[0]=t=>o.handleShowCart())})):(0,e.kq)("",!0),(0,e._)("div",B,[o.showCart&&o.total>0?((0,e.wg)(),(0,e.iD)("div",M,[(0,e._)("div",x,[(0,e._)("span",{class:"product__header__icon iconfont__check",innerHTML:o.allCheck?"":"",onClick:c[1]||(c[1]=()=>o.allCartCheck(o.shopId))},null,8,R),W,(0,e._)("div",{class:"product__header__clear",onClick:c[2]||(c[2]=t=>o.cleanProduct(o.shopId))}," 清空购物车 ")]),((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(o.productList,(t=>((0,e.wg)(),(0,e.iD)("div",{class:"product__item",key:t._id},[(0,e._)("div",{class:"product__item__checked iconfont__check",innerHTML:t.check?"":"",onClick:()=>o.handleCheck(o.shopId,t._id)},null,8,Y),(0,e._)("img",{class:"product__item__img",src:t.imgUrl,alt:""},null,8,$),(0,e._)("div",A,[(0,e._)("div",E,(0,h.zw)(t.name),1),(0,e._)("p",G,[J,(0,e.Uk)((0,h.zw)(t.price)+" ",1),(0,e._)("span",O,"¥"+(0,h.zw)(t.oldPrice),1)])]),(0,e._)("div",Q,[(0,e._)("span",{class:"product__num__minus",onClick:()=>{o.changeItemToCart(o.shopId,t._id,t,-1)}},"-",8,V),(0,e._)("span",X,(0,h.zw)(t.count||0),1),(0,e._)("span",{class:"product__num__plus",onClick:()=>{o.changeItemToCart(o.shopId,t._id,t,1)}},"+",8,tt)])])))),128))])):(0,e.kq)("",!0),(0,e._)("div",ct,[(0,e._)("div",at,[(0,e._)("img",{class:"check__icon__img",src:"http://www.dell-lee.com/imgs/vue3/basket.png",alt:"",onClick:c[3]||(c[3]=t=>o.handleShowCart())}),(0,e._)("div",et,(0,h.zw)(o.total),1)]),(0,e._)("div",ot,[(0,e.Uk)(" 总计："),(0,e._)("span",st,"¥ "+(0,h.zw)(o.price),1)]),(0,e._)("div",{class:"check__btn",onClick:c[4]||(c[4]=t=>o.checkout())},"去结算")])])])}a(7658);var _t=a(1120),rt={name:"Cart",setup(){const t=(0,H.oR)(),c=(0,l.yj)(),a=c.params.id,o=t.state.cartList,s=(0,d.iH)(!1),{changeItemToCart:n,productList:_,price:r}=(0,Z.F)(a),i=(0,e.Fl)((()=>{const t=o[a]?.productList;let c=0;if(t){for(let a in t){const e=t[a];c+=e.count}0===c&&(s.value=!1)}return c})),p=(c,a)=>{t.commit("handleCheck",{shopId:c,productId:a})},u=()=>{i.value>0&&(s.value=!s.value)},h=(0,e.Fl)((()=>{const t=o[a]?.productList;let c=!0;if(t)for(let a in t){const e=t[a];e.count>0&&!e.check&&(c=!1)}return c})),m=t=>{s.value=!s.value,o[t]={shopName:"",productList:{}}},C=t=>{const c=o[t]?.productList;if(c)for(let a in c)c[a].check=!0},v=()=>{i.value>0&&_t.Z.push({path:`/orderConfirmation/${a}`})};return{productList:_,shopId:a,cartList:o,total:i,price:r,changeItemToCart:n,handleCheck:p,cleanProduct:m,allCheck:h,allCartCheck:C,showCart:s,handleShowCart:u,checkout:v}}};const it=(0,j.Z)(rt,[["render",nt],["__scopeId","data-v-fb194a70"]]);var dt=it,lt={name:"Shop",components:{ShopInfo:u.Z,Content:P,Cart:dt},setup(){const t=(0,l.tv)(),c=(0,l.yj)(),a=(0,d.qj)({item:{}}),e=async()=>{const t=await(0,p.U)(`/api/shop/${c.params.id}`);200===t.status?a.item=t.data.data:alert("请求失败")};e();const o=()=>{t.back()};return{data:a,handleBack:o}}};const pt=(0,j.Z)(lt,[["render",i],["__scopeId","data-v-59f30b66"]]);var ut=pt}}]);
//# sourceMappingURL=916.d2b1a881.js.map