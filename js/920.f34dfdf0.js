"use strict";(self["webpackChunkmall"]=self["webpackChunkmall"]||[]).push([[920],{6041:function(t,a,s){s.d(a,{F:function(){return o}});var c=s(65),e=s(3396);const o=t=>{const a=(0,c.oR)(),s=a.state.cartList;let o=0;const r=(t,s,c,e)=>{a.commit("changeItemToCart",{shopId:t,productId:s,productInfo:c,num:e})},n=(t,s,c,e,r)=>{clearTimeout(o),o=0,o=setInterval((()=>{a.commit("changeItemToCart",{shopId:t,productId:s,productInfo:e,num:r}),a.commit("shopNameToCart",{shopId:t,shopName:c})}),300)},i=(t,s,c,e,r)=>{clearTimeout(o),0!=o&&(a.commit("changeItemToCart",{shopId:t,productId:s,productInfo:e,num:r}),a.commit("shopNameToCart",{shopId:t,shopName:c}))},_=(0,e.Fl)((()=>{const a=s[t]?.productList||{},c={};for(let t in a)a[t].count>0&&(c[t]=a[t]);return c})),d=(0,e.Fl)((()=>{const a=s[t]?.productList;let c=0;if(a)for(let t in a){const s=a[t];s.check&&(c+=s.count*s.price)}return c.toFixed(2)})),p=(0,e.Fl)((()=>s[t]?.shopName||""));return{changeItemToCart:r,changeItemToCart_touch:n,changeItemToCart_handle:i,productList:_,price:d,shopName:p}}},2920:function(t,a,s){s.r(a),s.d(a,{default:function(){return V}});var c=s(3396);const e={class:"wrapper"};function o(t,a,s,o,r,n){const i=(0,c.up)("TopArea"),_=(0,c.up)("ProductList"),d=(0,c.up)("Order");return(0,c.wg)(),(0,c.iD)("div",e,[(0,c.Wm)(i),(0,c.Wm)(_),(0,c.Wm)(d)])}const r=t=>((0,c.dD)("data-v-fa2c9aa2"),t=t(),(0,c.Cn)(),t),n={class:"top"},i=r((()=>(0,c._)("div",{class:"top__bgcolor"},null,-1))),_={class:"top__header"},d=(0,c.uE)('<div class="top__receiver" data-v-fa2c9aa2><div class="top__receiver__title" data-v-fa2c9aa2>收货地址</div><div class="top__receiver__address" data-v-fa2c9aa2>新疆昌吉市商城路亚馨家园</div><div class="top__receiver__info" data-v-fa2c9aa2><span class="top__receiver__info__name" data-v-fa2c9aa2>陈子涵</span><span class="top__receiver__info__name" data-v-fa2c9aa2>17609941226</span></div><div class="top__receiver__icon iconfont" data-v-fa2c9aa2></div></div>',1);function p(t,a,s,e,o,r){return(0,c.wg)(),(0,c.iD)("div",n,[i,(0,c._)("div",_,[(0,c._)("div",{class:"top__header__back iconfont",onClick:a[0]||(a[0]=t=>e.handleBack())},"  "),(0,c.Uk)(" 确认订单 ")]),d])}var l=s(1120),u={name:"TopArea",setup(){const t=()=>{l.Z.back()};return{handleBack:t}}},m=s(89);const v=(0,m.Z)(u,[["render",p],["__scopeId","data-v-fa2c9aa2"]]);var h=v,f=s(7139);const k={class:"products"},I={class:"products__title"},C={class:"products__wrapper"},w={class:"products__list"},g=["src"],L={class:"products__item__detail"},T={class:"products__item__title"},b={class:"products__item__price"},N={class:"products__item__yen"},F={class:"products__item__total"};function D(t,a,s,e,o,r){return(0,c.wg)(),(0,c.iD)("div",k,[(0,c._)("div",I,(0,f.zw)(e.shopName),1),(0,c._)("div",C,[(0,c._)("div",w,[((0,c.wg)(!0),(0,c.iD)(c.HY,null,(0,c.Ko)(e.productList,(t=>((0,c.wg)(),(0,c.iD)("div",{class:"products__item",key:t._id},[(0,c._)("img",{class:"products__item__img",src:t.imgUrl,alt:""},null,8,g),(0,c._)("div",L,[(0,c._)("div",T,(0,f.zw)(t.name),1),(0,c._)("p",b,[(0,c._)("span",N,"¥"+(0,f.zw)(t.price)+" × "+(0,f.zw)(t.count),1),(0,c._)("span",F,"¥"+(0,f.zw)((t.price*t.count).toFixed(2)),1)])])])))),128))])])])}var O=s(2483),y=s(65),z=s(6041),Z={name:"ProductList",setup(){const t=(0,O.yj)(),a=(0,y.oR)(),s=t.params.id,c=a.state.cartList,{productList:e,shopName:o}=(0,z.F)(s);return{shopId:s,cartList:c,productList:e,shopName:o}}};const A=(0,m.Z)(Z,[["render",D],["__scopeId","data-v-1f3f0893"]]);var P=A,H=s(9242);const R=t=>((0,c.dD)("data-v-5cc5f64e"),t=t(),(0,c.Cn)(),t),U={class:"order"},W={class:"order__price"},j={class:"order__price__num"},x=R((()=>(0,c._)("h3",{class:"mask__content__title"},"确认要离开收银台?",-1))),B=R((()=>(0,c._)("p",{class:"mask__content__desc"},"请尽快完成支付，否则将被取消",-1))),E={class:"mask__content__btns"};function K(t,a,s,e,o,r){return(0,c.wg)(),(0,c.iD)("div",null,[(0,c._)("div",U,[(0,c._)("div",W,[(0,c.Uk)(" 实付金额 "),(0,c._)("span",j,[(0,c._)("b",null,"¥"+(0,f.zw)(e.price),1)])]),(0,c._)("div",{class:"order__btn",onClick:a[0]||(a[0]=()=>e.submitOrder(!0))},"提交订单")]),(0,c.wy)((0,c._)("div",{class:"mask",onClick:a[4]||(a[4]=()=>e.submitOrder(!1))},[(0,c._)("div",{class:"mask__content",onClick:a[3]||(a[3]=(0,H.iM)((()=>{}),["stop"]))},[x,B,(0,c._)("div",E,[(0,c._)("div",{class:"mask__content__btn",onClick:a[1]||(a[1]=()=>e.handleConfirma(!0))}," 取消订单 "),(0,c._)("div",{class:"mask__content__btn confirmation",onClick:a[2]||(a[2]=()=>e.handleConfirma(!1))}," 确认支付 ")])])],512),[[H.F8,e.mask]])])}s(7658);var M=s(4870),Y=s(212),q={name:"Order",components:{TopArea:h,ProductList:P},setup(){const t=(0,O.tv)(),a=(0,O.yj)(),s=(0,y.oR)(),c=parseInt(a.params.id),{productList:e,price:o,shopName:r}=(0,z.F)(c),n=(0,M.iH)(!1),i=async a=>{try{const o=[];for(let t in e.value){const a=e.value[t];o.push({id:parseInt(a._id),num:a.count})}const n=await(0,Y.v)("/api/order/",{addressId:"昌吉",shopId:c,shopName:r.value,isCanceled:a,products:o});0===n.data.errno&&(!0===a?t.push({name:"Home"}):t.push({name:"OrderList"}),s.commit("clearCart",c))}catch(o){console.log("提示下单失败"+o)}},_=t=>{n.value=t};return{price:o,mask:n,handleConfirma:i,submitOrder:_}}};const G=(0,m.Z)(q,[["render",K],["__scopeId","data-v-5cc5f64e"]]);var J=G,Q={name:"OrderConfirmation",components:{TopArea:h,ProductList:P,Order:J},setup(){return{}}};const S=(0,m.Z)(Q,[["render",o],["__scopeId","data-v-2e8824c6"]]);var V=S}}]);
//# sourceMappingURL=920.f34dfdf0.js.map